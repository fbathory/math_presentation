---
title: "Models for population growth"
author: 
  - name: "Florencia Bathory" 
    email: bathory@demogr.mpg.de
  - name: "Martina Bodo"
    email: bodo@demogr.mpg.de
  - name: "Anwer Hossain"
    email: hossain@demogr.mpg.de
  - name: "Fabio Pastor Duarte"
    email: pastorduarte@demogr.mpg.de
#institute: "Universidad Nacional de Luj√°n"
lang: en
date: "17/08/2024"
date-format: "DD MMMM YYYY"
format:
  revealjs: 
    touch: false
    preview-links: true
    controls: true
    theme: [white, custom.scss]
    smaller: true
    #theme: moon
    self-contained: false
    slide-number: c/t
    logo: images/edsd-logo.png
    css: logo.css
    # footer: "[https://fbathory.github.io/tesis-mg](https://fbathory.github.io/tesis-mg)"
# suppress-bibliography: true
---

## Contents

-   Population modeling: basic concepts

-   Population models: linear growth

-   Population models: exponential growth

-   Population models: logistic growth

-   Comparison on the long-term

## Basic concepts

We are going to go through some basic models for population growth, in which age and most other features of real populations are disregarded

::: {.fragment .fade-in}
A population count at time $t$ is denoted by $P_t$ when we use discrete values, or $P(t)$ over a continuum of time
:::

::: {.fragment .fade-in}

Let's use a population of 4 rabbits as an example and their rate of growth is 10% per year

![](images/rabbits2.jpg){.lightbox fig-align="center" width="50%"}

:::

::: {.fragment .fade-in}
So we have 4 rabbits (us in our previous lives), and let's say $t_0=1950$ and $r=.1$

:::

## Linear growth

::: columns
::: {column-width="40%"}
Let's say the population of rabbits grows linearly. That means that in a linear expression $y = a+b*x$ we can describe as $P(t)=P(t_0)+r*(t-t_0)$ 
So, what do we know so far? 
$$
P(t)=4+0.1*(t-1950)
$$ Then, we get a plot that looks like this
:::

::: {.column-width="60%}
```{r}
library(tidyverse)
library(ggplot2)
t <- data.frame(t= c(1950,1960,1970,1980,1990,2000,2010,2020))
p0 <- 4
t0 <- 1950

linear_g <- function(t,r){
  a <- p0
  result <- a+r*(t-1950)
  return(result)
}

t_linear <- t |> 
  mutate(P = round(linear_g(t=t, r=.1),0))

p_linear <- ggplot(data = t_linear, 
       aes(x=t, y=P))+
  geom_line()+
  theme_bw()+
  labs(x = "t",
       y = "P(t)")

p_linear
```
:::

:::

## Exponential growth

::: incremental
But we know populations don't usually grow in a linear way, but mostly reflects geometric growth if $P(t)=P(0)*(1+x)^r$ being $x$ ????, which, as we've seen, when $x$ is compounded $j$ times per year and the rate is compounded continuously, we get $lim_{j\to\infty} (1+\frac{r}{j})^r=e^r$.
If we assume population increases without limitations along time, we get the model of exponential growth
$$
P(t)=P(0)*e^{r(t-t_0)}
$$
If we derive????? this function, we get that the differential equation get us $r$????
Which is a J-shaped curve (as the $\mu(x)$ function)

```{r}

exponential_g <- function(t,r){
  result <- p0*exp(r*(t-t0))
  return(result)
}

t_exponential <- t |> 
  mutate(P=round(exponential_g(t=t, r=.1),0))

p_exponential <- ggplot(data = t_exponential, 
       aes(x=t, y=P))+
  geom_line()+
  theme_bw()+
  labs(x = "t",
       y = "P(t)")

p_exponential
```
:::

## Logistic growth

::: incremental 
But unlimited growth can only happen for a limited amount of time.
We then put a limit to the logistic growth because environmental, resources and predators could constrict that growth. For that, we have to assume an ultimate population so that $lim_{t\to\infty} P(t)=a$
The solution for the differential equation, then, is
$$
P(t)=\frac{a}{(1+e^{-r(t-t_0)})}
$$

```{r}
logistic_g <- function(t,r,a=2000){
  numerator <- a
  denominator <- 1+exp((-r)*(t-t0))
  pt <- numerator/denominator
  return(pt)
}

t_logistic <- t |> 
  mutate(P=round(logistic_g(t=t, r=.1),0))

p_logistic <- ggplot(data = t_logistic, 
       aes(x=t, y=P))+
  geom_line()+
  theme_bw()+
  labs(x = "t",
       y = "P(t)")

p_logistic
```

:::
## Comparison on the long-term

# Thank you! {style="text-align: center"}

-   üìß [bathory\@demogr.mpg.de](mailto:bathory@demogr.mpg.de)

-   üìß [bodo\@demogr.mpg.de](mailto:bodo@demogr.mpg.de)

-   üìß [hossain\@demogr.mpg.de](mailto:hossain@demogr.mpg.de)

-   üìß [pastorduarte\@demogr.mpg.de](mailto:pastorduarte)
